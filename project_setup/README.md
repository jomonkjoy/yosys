# counter_synth — Yosys + sky130 RTL Synthesis Example

## Directory Structure

```
counter_synth/
├── Makefile                         ← Top-level build system
├── filelist/
│   └── rtl.f                        ← Source filelist (one RTL file per line)
├── rtl/
│   └── counter.v                    ← 8-bit synchronous counter RTL
├── constraints/
│   └── counter.sdc                  ← SDC timing constraints (100 MHz)
└── synth/
    ├── scripts/
    │   ├── synth.ys                 ← Yosys synthesis script
    │   └── read_rtl.ys              ← Auto-generated by Makefile at build time
    ├── reports/                     ← Generated: area, timing, logs
    │   ├── synth_stat.rpt
    │   ├── synth_check.rpt
    │   └── yosys.log
    └── netlist/                     ← Generated: gate-level Verilog
        └── counter_netlist.v
```

## Prerequisites

| Tool | Version tested | Install |
|------|---------------|---------|
| Yosys | ≥ 0.36 | `sudo apt install yosys` or build from source |
| sky130A PDK | open_pdks | [RTimothyEdwards/open_pdks](https://github.com/RTimothyEdwards/open_pdks) |
| Verilator | ≥ 5.0 (lint only) | `sudo apt install verilator` |
| OpenSTA | ≥ 2.5 (optional STA) | [The-OpenROAD-Project/OpenSTA](https://github.com/The-OpenROAD-Project/OpenSTA) |

## Quick Start

```bash
# 1 – point to your PDK installation
export SKY130_ROOT=/path/to/open_pdks/sky130A

# 2 – lint the RTL
make lint

# 3 – synthesise
make

# 4 – inspect area report
cat synth/reports/synth_stat.rpt

# 5 – view gate-level graph (optional, needs xdot)
make show
```

## Makefile Targets

| Target | Description |
|--------|-------------|
| `make` / `make synth` | Run full synthesis flow |
| `make lint` | Verilator lint (syntax + style) |
| `make show` | Open graphviz view of gate netlist |
| `make clean` | Remove all generated files |
| `make help` | Print variable summary |

## Synthesis Flow (Yosys passes)

```
read_verilog → hierarchy → proc → flatten
→ opt / wreduce / peepopt / share      (pre-map optimisation)
→ dfflibmap  (FF mapping  → sky130 dfxtp)
→ abc        (combo mapping, 100 MHz target)
→ opt_clean / setundef
→ write_verilog  (gate-level netlist)
```

## Timing Target

* Clock: `clk`, 100 MHz (period = 10 ns)  
* Input delay:  4 ns max / 0.5 ns min  
* Output delay: 4 ns max / 0.5 ns min  
* Library corner: TT / 25 °C / 1.8 V (`sky130_fd_sc_hd__tt_025C_1v80.lib`)

## Adding More RTL Files

Edit `filelist/rtl.f` and add one path per line (relative to project root):

```
rtl/counter.v
rtl/another_module.v
rtl/sub/yet_another.v
```

The Makefile reads the filelist and generates the Yosys `read_verilog` commands automatically.
